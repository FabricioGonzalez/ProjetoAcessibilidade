<UserControl
    x:Class="ProjectAvalonia.Features.Project.Views.ProjectExplorerView"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:ProjectAvalonia.Common.Controls;assembly=ProjectAvalonia"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i="clr-namespace:Avalonia.Xaml.Interactivity;assembly=Avalonia.Xaml.Interactivity"
    xmlns:ia="clr-namespace:Avalonia.Xaml.Interactions.Core;assembly=Avalonia.Xaml.Interactions"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="using:ProjectAvalonia.Features.Project.ViewModels"
    d:DesignHeight="450"
    d:DesignWidth="800"
    x:DataType="viewModels:ProjectExplorerViewModel"
    mc:Ignorable="d">
    <Grid Name="ExplorerRoot" RowDefinitions="48,1*">
        <StackPanel
            Margin="16,0"
            HorizontalAlignment="Left"
            Orientation="Horizontal"
            Spacing="4">
            <ToggleButton
                x:Name="SolutionFlyoutButton"
                Width="40"
                Height="36"
                Classes="plain"
                Command="{Binding OpenSolutionCommand}"
                IsChecked="{Binding projectExplorerViewModel.IsDocumentSolutionEnabled, Mode=TwoWay}"
                ToolTip.Tip="Visualizar Solução">
                <PathIcon Data="{StaticResource document_regular}" />
                <!--<material:MaterialIcon Kind="DocumentSign" />-->
                <ToggleButton.Flyout>
                    <controls:SolutionFlyout SolutionModel="{Binding SolutionModel}" />
                </ToggleButton.Flyout>
            </ToggleButton>
            <Button
                x:Name="SaveSolutionButton"
                Width="40"
                Height="36"
                Classes="function"
                Command="{Binding SaveSolutionCommand}"
                ToolTip.Tip="Sincronizar Solução">
                <PathIcon Data="{StaticResource save_regular}" />
                <!--<material:MaterialIcon Kind="ContentSave" />-->
            </Button>
            <Button
                x:Name="AppPrintButton"
                Width="40"
                Height="36"
                Classes="action"
                Command="{Binding PrintProjectCommand}"
                ToolTip.Tip="Imprimir">
                <PathIcon Data="{StaticResource printer_regular}" />
                <!--<material:MaterialIcon Kind="PrintPreview" />-->
            </Button>
        </StackPanel>
        <TreeView
            x:Name="explorerTreeView"
            Grid.Row="1"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            CornerRadius="8">
            <TreeView.DataTemplates>
                <TreeDataTemplate DataType="viewModels:FolderProjectItemViewModel" ItemsSource="{Binding Children}">
                    <Grid
                        Margin="2"
                        HorizontalAlignment="Stretch"
                        ColumnDefinitions="32,1*">
                        <!--<material:MaterialIcon Grid.Column="0" Kind="Folder" />-->
                        <controls:EditableTextBlock
                            Grid.Column="1"
                            HorizontalAlignment="Stretch"
                            Command="{Binding CommitChangeCommand}"
                            InEditMode="{Binding InEditMode}"
                            Text="{Binding Title}" />
                        <Grid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Command="{Binding RenameCommand}" Header="Rename" />
                                <MenuItem Command="{Binding DeleteCommand}" Header="Delete" />
                                <MenuItem
                                    Command="{Binding #explorerView.DataContext.AddItemCommand}"
                                    CommandParameter="{Binding}"
                                    Header="Add Item" />
                                <MenuItem
                                    Command="{Binding #explorerView.DataContext.AddFolderCommand}"
                                    CommandParameter="{Binding}"
                                    Header="Add Folder" />
                            </ContextMenu>
                        </Grid.ContextMenu>
                    </Grid>
                </TreeDataTemplate>
                <DataTemplate DataType="viewModels:FileProjectItemViewModel">
                    <Grid
                        Margin="2"
                        HorizontalAlignment="Stretch"
                        ColumnDefinitions="32,1*">
                        <i:Interaction.Behaviors>
                            <ia:EventTriggerBehavior EventName="DoubleTapped">
                                <ia:InvokeCommandAction Command="{Binding #explorerView.DataContext.SelectSolutionItemCommand}" CommandParameter="{Binding}" />
                            </ia:EventTriggerBehavior>
                        </i:Interaction.Behaviors>

                        <!--<material:MaterialIcon Grid.Column="0" Kind="File" />-->
                        <controls:EditableTextBlock
                            Grid.Column="1"
                            HorizontalAlignment="Stretch"
                            Command="{Binding CommitChangeCommand}"
                            InEditMode="{Binding InEditMode}"
                            Text="{Binding Title}" />

                        <Grid.ContextMenu>
                            <ContextMenu>
                                <MenuItem Command="{Binding RenameCommand}" Header="Rename" />
                                <MenuItem Command="{Binding DeleteCommand}" Header="Delete" />
                            </ContextMenu>
                        </Grid.ContextMenu>
                    </Grid>
                </DataTemplate>
            </TreeView.DataTemplates>
        </TreeView>
    </Grid>
</UserControl>
